# renotate設定ファイル
# 依存関係の自動更新を管理する

# 更新対象のパッケージマネージャー
package_managers:
  - npm  # frontend/package.json
  - go   # backend/go.mod

# 更新スケジュール（毎日午前2時）
schedule: "0 2 * * *"

# 自動マージの設定
auto_merge:
  # メジャーアップデート以外は自動マージ
  enabled: true
  # メジャーアップデートは手動確認が必要
  major_updates: false
  # マイナー・パッチアップデートは自動マージ
  minor_updates: true
  patch_updates: true

# 更新対象のパッケージフィルター
package_filters:
  # 除外するパッケージ（例：破壊的変更が多いパッケージ）
  exclude:
    - "react"  # React 19は破壊的変更が多いため手動確認
    - "react-dom"
  
  # 含めるパッケージ（空の場合は全て）
  include: []

# 更新の制限
update_limits:
  # 一度に更新するパッケージの最大数
  max_packages_per_pr: 10
  # 1週間に作成するPRの最大数
  max_prs_per_week: 5

# PRの設定
pull_request:
  # PRのタイトルテンプレート
  title_template: "chore: 依存関係を更新 ({{package_count}}個のパッケージ)"
  
  # PRの本文テンプレート
  body_template: |
    ## 依存関係の自動更新
    
    このPRはrenotateによって自動的に作成されました。
    
    ### 更新されたパッケージ
    {{#packages}}
    - **{{name}}**: {{old_version}} → {{new_version}}
    {{/packages}}
    
    ### 更新の種類
    - マイナーアップデート: {{minor_count}}個
    - パッチアップデート: {{patch_count}}個
    
    ### 確認事項
    - [ ] テストが通ることを確認
    - [ ] ビルドが成功することを確認
    - [ ] 動作確認（必要に応じて）
  
  # ラベル
  labels:
    - "dependencies"
    - "automated"
    - "renotate"
  
  # レビュアー（空の場合は自動マージ）
  reviewers: []
  
  # アサイニー（空の場合は自動マージ）
  assignees: []

# 通知設定
notifications:
  # 失敗時の通知
  on_failure: true
  # 成功時の通知
  on_success: false
  # メジャーアップデート発見時の通知
  on_major_update: true

# セキュリティ更新の優先度
security_updates:
  # セキュリティ更新は即座にマージ
  auto_merge: true
  # セキュリティ更新の通知
  notify: true

# ブランチ設定
branch:
  # 更新用ブランチのプレフィックス
  prefix: "renotate"
  # ベースブランチ
  base: "main"

# コミット設定
commit:
  # コミットメッセージのテンプレート
  message_template: "chore: {{package_name}}を{{old_version}}から{{new_version}}に更新"
  # コミットの署名
  sign: false

# テスト設定
testing:
  # 更新後のテスト実行
  run_tests: true
  # テストコマンド
  test_commands:
    - "cd frontend && bun run lint"
    - "cd frontend && bun run build"
    - "cd backend && go test ./..."
  # テストが失敗した場合のPR作成をスキップ
  skip_on_test_failure: true